{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{ course.title }}</title>
<link rel="stylesheet" href="{% static 'css/style.css' %}">
<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #f5f7fa, #e4f7e4);
    color: #1a202c;
    scroll-behavior: smooth;
  }
  nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 2rem;
    background-color: white;
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    position: sticky;
    top: 0;
    z-index: 999;
  }
  nav .logo { font-size: 1.7rem; font-weight: bold; color: #32CD32; }
  nav .nav-links { display: flex; gap: 1.8rem; }
  nav .nav-links a { color: #1a202c; font-weight: 500; transition: 0.3s; }
  nav .nav-links a:hover { color: #32CD32; }

  .container { width: 92%; max-width: 1100px; margin: 2rem auto; }

  .back-link {
    color: #32CD32;
    text-decoration: none;
    display: inline-block;
    margin-bottom: 1.5rem;
    font-weight: 500;
    transition: 0.3s;
  }
  .back-link:hover { text-decoration: underline; }

  .course-box {
    background: white;
    border-radius: 1rem;
    box-shadow: 0 10px 25px rgba(0,0,0,0.08);
    overflow: hidden;
    max-width: 800px;
    margin: 0 auto;
    transition: transform 0.3s, box-shadow 0.3s;
  }
  .course-box:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); }

  .course-image {
    width: 100%;
    height: 300px;
    object-fit: cover;
    border-top-left-radius: 1rem;
    border-top-right-radius: 1rem;
  }

  .course-content {
    padding: 2rem;
    text-align: center;
  }

  .course-content h1 { margin-bottom: 0.5rem; font-size: 2.2rem; }
  .course-content p { color: #4a5568; margin-bottom: 1.5rem; font-size: 1.05rem; line-height: 1.6; }

  .course-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
    margin-top: 1rem;
  }
  .price {
    color: #32CD32;
    font-weight: bold;
    font-size: 1.7rem;
  }
  .btn-primary {
    background-color: #32CD32;
    color: white;
    padding: 0.8rem 1.8rem;
    border-radius: 9999px;
    font-weight: bold;
    text-decoration: none;
    transition: 0.3s;
  }
  .btn-primary:hover { background-color: #28a428; }

  /* Optional: Instructor Info */
  .instructor {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-top: 2rem;
    justify-content: center;
  }
  .instructor img {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    object-fit: cover;
  }
  .instructor span { font-weight: 500; }

  /* Responsive */
  @media (max-width: 768px) {
    .course-footer { flex-direction: column; }
    .course-content h1 { font-size: 1.8rem; }
    .course-content p { font-size: 1rem; }
  }
  .btn-start {
    display: inline-block;
    padding: 0.5rem 1rem;
    background-color: #28a745;
    color: #fff;
    font-weight: bold;
    border-radius: 6px;
    text-decoration: none;
    margin-left: 10px;
    transition: background 0.2s;
}

.btn-start:hover {
    background-color: #218838;
}

</style>

<style>
/* Optional minimal styling */
.modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); }
.modal-content { background:#fff; padding:20px; margin:10% auto; width:300px; position:relative; border-radius:8px; }
.close { position:absolute; top:10px; right:15px; font-size:20px; cursor:pointer; }
.btn { padding:10px 20px; border:none; border-radius:5px; cursor:pointer; margin:5px; }
.btn-primary { background:#4CAF50; color:white; }
.btn-secondary { background:#f44336; color:white; }
</style>

</head>
<body>

<!-- Navbar -->
<nav>
  <div class="logo">E-Learn</div>
  <div class="nav-links">
    <a href="{% url 'home' %}">Home</a>
    <a href="{% url 'courses:course_list' %}">Courses</a>
  </div>
</nav>

<div class="container">
    <a href="{% url 'courses:course_list' %}" class="back-link">&larr; Back to Courses</a>
    
    <div class="course-box">
        <!-- Course Image -->
        {% if course.image %}
            <img src="{{ course.image.url }}" alt="{{ course.title }}" class="course-image">
        {% else %}
            <img src="{% static 'images/default.jpg' %}" alt="{{ course.title }}" class="course-image">
        {% endif %}

        <div class="course-content">
            <h1>{{ course.title }}</h1>
            <p>{{ course.description }}</p>

            <div class="course-footer">
                <span class="price">â‚¹{{ course.price }}</span>

                <!-- Buy Course Button -->
                <a href="{% url 'payments:checkout' course.id %}" class="btn-primary">ðŸ’³ Buy Course</a>

                <!-- Start Course Button -->
                <button id="start-course-btn" class="btn btn-primary" data-slug="{{ course.slug }}">
                    {% if user.is_authenticated %}
                        â–¶ Start Course
                    {% else %}
                        Login to Start
                    {% endif %}
                </button>
            </div>

            <!-- Optional Instructor Info -->
            {% if course.instructor %}
                <div class="instructor">
                    {% if course.instructor.profile_image %}
                        <img src="{{ course.instructor.profile_image.url }}" alt="{{ course.instructor.name }}">
                    {% else %}
                        <img src="{% static 'images/default-instructor.jpg' %}" alt="{{ course.instructor.name }}">
                    {% endif %}
                    <span>Instructor: {{ course.instructor.name }}</span>
                </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Login Modal Popup -->
<div id="loginModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h3>Login to continue</h3>
    <form id="loginForm" method="POST" action="{% url 'login' %}?next={{ request.path }}">
        {% csrf_token %}
        <input type="text" name="username" placeholder="Username" required>
        <input type="password" name="password" placeholder="Password" required>
        <button type="submit">Login</button>
    </form>
  </div>
</div>

<script>
// Start course button logic
const startBtn = document.getElementById('start-course-btn');
const loginModal = document.getElementById('loginModal');
const closeBtn = loginModal.querySelector('.close');

startBtn.addEventListener('click', () => {
    {% if not user.is_authenticated %}
        loginModal.style.display = 'block'; // show login popup
    {% else %}
        // redirect to course player/start
        window.location.href = "{% url 'courses:course_start' course.slug %}";
    {% endif %}
});

// Close modal
closeBtn.addEventListener('click', () => loginModal.style.display = 'none');
window.addEventListener('click', (e) => {
    if(e.target == loginModal) loginModal.style.display = 'none';
});
</script>




</body>
</html>
